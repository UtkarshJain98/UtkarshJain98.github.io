import java.util.*;                                                                                                                                                                                                                             /**                                                                                                                      * Ferry                                                                                                                 *                                                                                                                       * ferry loading problem                                                                                                 *                                                                                                                       * @author parth_shel                                                                                                    * @version v:1.3 - Nov. 5, 2017                                                                                         */                                                                                                                     public class Ferry {                                                                                                                                                                                                                                private static int ferryLength;                                                                                         private static HashSet<Config> mapOfConfigs; //(lt,rt) stored for memoization                                                                                                                                                                   private static class Config {                                                                                               private int leftLen;                                                                                                    private int rightLen;                                                                                                                                                                                                                           public Config(int leftLen, int rightLen) {                                                                                  this.leftLen = leftLen;                                                                                                 this.rightLen = rightLen;                                                                                           }                                                                                                                                                                                                                                               @Override                                                                                                               public boolean equals(Object o) {                                                                                           if (this == o) return true;                                                                                             if (!(o instanceof Config)) return false;                                                                                                                                                                                                       Config config = (Config) o;                                                                                                                                                                                                                     return ((this.leftLen == config.leftLen && this.rightLen == config.rightLen));                                      }                                                                                                                                                                                                                                               @Override                                                                                                               public int hashCode() {                                                                                                     int result = leftLen;                                                                                                   result = 1572869 * result + rightLen;                                                                                   return result;                                                                                                      }                                                                                                                   }                                                                                                                                                                                                                                               private static int maxCars(int lt, int rt, int[] cars, int i) {                                                             //basis case: stop recursion when all cars have been fitted                                                             if (i == cars.length) {                                                                                                     return i;                                                                                                           }                                                                                                                                                                                                                                               //check if this config has already been seen                                                                            if (mapOfConfigs.contains(new Config(lt, rt)) || mapOfConfigs.contains(new Config(rt, lt))) {                               return i;                                                                                                           }                                                                                                                                                                                                                                               if (lt - cars[i] < 0 && rt - cars[i] < 0) { //basis case                                                                    return i;                                                                                                           } else if (lt - cars[i] < 0) { //left full                                                                                  return maxCars(lt, rt - cars[i], cars, i + 1);                                                                      } else if (rt - cars[i] < 0) { //right full                                                                                 return maxCars(lt - cars[i], rt, cars, i + 1);                                                                      }                                                                                                                                                                                                                                               int max = Math.max(maxCars(lt - cars[i], rt, cars, i + 1), maxCars(lt, rt - cars[i], cars, i + 1));                     mapOfConfigs.add(new Config(lt, rt)); //memoize to reduce recursive calls                                               return max;                                                                                                         }                                                                                                                                                                                                                                               public static void main(String args[]) {                                                                                    ferryLength = Integer.parseInt(args[0]);                                                                                int numCars = StdIn.readInt();                                                                                          int cars[] = new int[numCars];                                                                                          for (int i = 0; i < numCars; i++) {                                                                                         cars[i] = StdIn.readInt();                                                                                          }                                                                                                                       mapOfConfigs = new HashSet<>(2 << (numCars - 2));                                                                       int result = maxCars(ferryLength, ferryLength, cars, 0);                                                                StdOut.println(result);                                                                                             }                                                                                                                   }
